{"version":3,"file":"index.es.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/utils/constants.ts","../src/hooks/usePrevious.ts","../src/services/contributions.ts","../src/utils/index.ts","../src/components/Heatmap/index.tsx"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","// GitHub theme\nexport type Theme = {\n  [key: string]: string;\n  background: string;\n  text: string;\n  grade4: string;\n  grade3: string;\n  grade2: string;\n  grade1: string;\n  grade0: string;\n};\n\nexport const DEFAULT_THEME = {\n  background: 'transparent',\n  text: '#000',\n  grade4: '#196127',\n  grade3: '#239a3b',\n  grade2: '#7bc96f',\n  grade1: '#c6e48b',\n  grade0: '#ebedf0',\n};\n\nexport const NAMESPACE = 'react-github-heatmap';\n\nexport const LINE_HEIGHT = 1.5;\nexport const MIN_DISTANCE_MONTH_LABELS = 2;\nexport const TITLE_SCALE_FACTOR = 1.25;\n","import { useRef, useEffect } from 'react';\n\nexport function usePrevious<T>(value: T) {\n  const ref = useRef<T>(value);\n\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n\n  return ref.current;\n}\n","// Import modules separately to reduce bundle size\nimport addDays from 'date-fns/addDays';\nimport format from 'date-fns/format';\nimport getDay from 'date-fns/getDay';\nimport getMonth from 'date-fns/getMonth';\nimport isAfter from 'date-fns/isAfter';\nimport isSameYear from 'date-fns/isSameYear';\nimport parseISO from 'date-fns/parseISO';\nimport setDay from 'date-fns/setDay';\nimport subYears from 'date-fns/subYears';\n\nconst DATE_FORMAT = 'yyyy-MM-dd';\n\nexport type GraphData = {\n  year: number;\n  blocks: Block[][];\n  monthLabels: { x: number; label: string }[];\n  totalCount: number;\n};\n\nexport type Block = {\n  date: string;\n  info?: {\n    date: string;\n    count: number;\n    color: string;\n    intensity: number;\n  };\n};\n\nexport type MonthLabels = {\n  x: number;\n  label: string;\n}[];\n\nexport type HeatmapData = {\n  years: {\n    year: string;\n    total: number;\n    range: {\n      start: string;\n      end: string;\n    };\n  }[];\n  contributions: {\n    date: string;\n    count: number;\n    color: string;\n    intensity: number;\n  }[];\n};\n\nexport type RequestOptions = {\n  fullYear: boolean;\n  years: number[];\n  data: HeatmapData;\n};\n\nfunction getContributionsForDate(data: HeatmapData, date: string) {\n  return data.contributions.find(contrib => contrib.date === date);\n}\n\nfunction getContributionCountForLastYear(data: HeatmapData) {\n  const { contributions } = data;\n  const now = new Date();\n\n  // Start date for accumulating the values\n  const begin = contributions.findIndex(contrib => contrib.date === format(now, DATE_FORMAT));\n\n  // No data for today given\n  if (begin === -1) {\n    return 0;\n  }\n\n  // Check if there is data for the day one year past\n  let end = contributions.findIndex(contrib => {\n    return contrib.date === format(subYears(now, 1), DATE_FORMAT);\n  });\n\n  // Take the oldest contribution otherwise, if not enough data exists\n  if (end === -1) {\n    end = contributions.length - 1;\n  }\n\n  return contributions.slice(begin, end).reduce((acc, contrib) => acc + contrib.count, 0);\n}\n\nfunction getContributionCountForYear(data: HeatmapData, year: number) {\n  const yearEntry = data.years.find(entry => entry.year === String(year));\n\n  return yearEntry ? yearEntry.total : 0;\n}\n\nfunction getBlocksForYear(year: number, data: HeatmapData, fullYear: boolean) {\n  const now = new Date();\n  const firstDate = fullYear ? subYears(now, 1) : parseISO(`${year}-01-01`);\n  const lastDate = fullYear ? now : parseISO(`${year}-12-31`);\n\n  let weekStart = firstDate;\n\n  // The week starts on Sunday - add days to get to next sunday if neccessary\n  if (getDay(firstDate) !== 0) {\n    weekStart = addDays(firstDate, getDay(firstDate));\n  }\n\n  // Fetch graph data for first row (Sundays)\n  const firstRowDates = [];\n  while (weekStart <= lastDate) {\n    const date = format(weekStart, DATE_FORMAT);\n\n    firstRowDates.push({\n      date,\n      info: getContributionsForDate(data, date),\n    });\n\n    weekStart = setDay(weekStart, 7);\n  }\n\n  // Add the remainig days per week (column for column)\n  return firstRowDates.map(dateObj => {\n    const dates = [];\n    for (let i = 0; i <= 6; i += 1) {\n      const date = format(setDay(parseISO(dateObj.date), i), DATE_FORMAT);\n\n      if (isAfter(parseISO(date), lastDate)) {\n        break;\n      }\n\n      dates.push({\n        date,\n        info: getContributionsForDate(data, date),\n      });\n    }\n\n    return dates;\n  });\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction getMonthLabels(blocks: GraphData['blocks'], fullYear: boolean): MonthLabels {\n  const weeks = blocks.slice(0, fullYear ? blocks.length - 1 : blocks.length);\n  let previousMonth = 0; // January\n\n  return weeks.reduce<MonthLabels>((labels, week, x) => {\n    const firstWeekDay = parseISO(week[0].date);\n    const month = getMonth(firstWeekDay) + 1;\n    const monthChanged = month !== previousMonth;\n    const firstMonthIsDecember = x === 0 && month === 12;\n\n    if (monthChanged && !firstMonthIsDecember) {\n      labels.push({\n        x,\n        label: format(firstWeekDay, 'MMM'),\n      });\n      previousMonth = month;\n    }\n\n    return labels;\n  }, []);\n}\n\nfunction getGraphDataForYear(year: number, data: HeatmapData, fullYear: boolean): GraphData {\n  const blocks = getBlocksForYear(year, data, fullYear);\n  const monthLabels = getMonthLabels(blocks, fullYear);\n  const totalCount = fullYear\n    ? getContributionCountForLastYear(data)\n    : getContributionCountForYear(data, year);\n\n  return {\n    year,\n    blocks,\n    monthLabels,\n    totalCount,\n  };\n}\n\nexport function getGitHubGraphData(options: RequestOptions): GraphData[] {\n  const { fullYear, years, data } = options;\n\n  if (!data.years.length) {\n    throw Error('No data available');\n  }\n\n  return years.map(year => {\n    const isCurrentYear = isSameYear(parseISO(String(year)), new Date());\n\n    return getGraphDataForYear(year, data, isCurrentYear && fullYear);\n  });\n}\n","import color, { ColorInput } from 'tinycolor2';\n\nimport { DEFAULT_THEME, NAMESPACE, Theme } from './constants';\n\nexport function createCalendarTheme(\n  baseColor: ColorInput,\n  textColor = 'inherit',\n  emptyCellColor = color('white')\n    .darken(8)\n    .toHslString(),\n  background = 'transparent',\n): Theme {\n  const base = color(baseColor);\n\n  if (!base.isValid()) {\n    return DEFAULT_THEME;\n  }\n\n  const text = color(textColor).isValid() ? String(color(textColor)) : DEFAULT_THEME.text;\n\n  return {\n    background,\n    text,\n    grade4: base.setAlpha(0.92).toHslString(),\n    grade3: base.setAlpha(0.76).toHslString(),\n    grade2: base.setAlpha(0.6).toHslString(),\n    grade1: base.setAlpha(0.44).toHslString(),\n    grade0: emptyCellColor,\n  };\n}\n\nexport function getClassName(name: string, extra?: string) {\n  if (extra) {\n    return `${NAMESPACE}__${name} ${extra}`;\n  }\n\n  return `${NAMESPACE}__${name}`;\n}\n","import React, { useState, CSSProperties, useEffect, useCallback } from 'react';\nimport format from 'date-fns/format';\nimport parseISO from 'date-fns/parseISO';\nimport getYear from 'date-fns/getYear';\nimport { ColorInput } from 'tinycolor2';\n\nimport styles from './styles.css';\n\nimport {\n  DEFAULT_THEME,\n  LINE_HEIGHT,\n  MIN_DISTANCE_MONTH_LABELS,\n  NAMESPACE,\n  Theme,\n} from '../../utils/constants';\nimport { usePrevious } from '../../hooks/usePrevious';\nimport { getGitHubGraphData, GraphData, Block, HeatmapData } from '../../services/contributions';\nimport { createCalendarTheme, getClassName } from '../../utils';\n\nexport type Props = {\n  data: HeatmapData;\n  blockSize?: number;\n  blockMargin?: number;\n  color?: ColorInput;\n  dateFormat?: string;\n  fontSize?: number;\n  fullYear?: boolean;\n  style?: CSSProperties;\n  theme?: Theme;\n  years?: number[];\n};\n\nexport const Heatmap: React.FC<Props> = ({\n  blockSize = 12,\n  blockMargin = 2,\n  children,\n  color = undefined,\n  dateFormat = 'MMM d, yyyy',\n  fontSize = 14,\n  fullYear = true,\n  theme = undefined,\n  data,\n  style = {},\n  years = [Number(format(new Date(), 'yyyy'))],\n}) => {\n  const [graphs, setGraphs] = useState<GraphData[] | null>(null);\n  const [error, setError] = useState<Error | null>(null);\n\n  const prevYears = usePrevious(years);\n  const prevFullYear = usePrevious(fullYear);\n\n  const fetchData = useCallback(() => {\n    setError(null);\n    setGraphs(\n      getGitHubGraphData({\n        data,\n        years,\n        fullYear,\n      }),\n    );\n  }, [years, data, fullYear]);\n\n  // Fetch data on mount\n  useEffect(() => {\n    fetchData();\n  }, []); // eslint-disable-line\n\n  // Refetch if relevant props change\n  useEffect(() => {\n    if (prevFullYear !== fullYear || prevYears.some(y => !years.includes(y))) {\n      fetchData();\n    }\n  }, [fetchData, fullYear, prevFullYear, prevYears, years]);\n\n  function getTheme(): Theme {\n    if (theme) {\n      return Object.assign({}, DEFAULT_THEME, theme);\n    }\n\n    if (color) {\n      return createCalendarTheme(color);\n    }\n\n    return DEFAULT_THEME;\n  }\n\n  function getDimensions() {\n    const textHeight = Math.round(fontSize * LINE_HEIGHT);\n\n    // Since weeks start on Sunday, there is a good chance that the graph starts\n    // in the week before January 1st. Therefore, the calendar shows 53 weeks.\n    const width = (52 + 1) * (blockSize + blockMargin) - blockMargin;\n    const height = textHeight + (blockSize + blockMargin) * 7 - blockMargin;\n\n    return { width, height };\n  }\n\n  function getTooltipMessage(day: Required<Block>) {\n    const date = parseISO(day.date);\n    return `<strong>${day.info.count} contributions</strong> on ${format(date, dateFormat)}`;\n  }\n\n  function renderMonthLabels(monthLabels: GraphData['monthLabels']) {\n    const style = {\n      fill: getTheme().text,\n      fontSize,\n    };\n\n    // Remove the first month label if there's not enough space to the next one\n    // (end of previous month)\n    if (monthLabels[1].x - monthLabels[0].x <= MIN_DISTANCE_MONTH_LABELS) {\n      monthLabels.shift();\n    }\n\n    return monthLabels.map(month => (\n      <text x={(blockSize + blockMargin) * month.x} y={fontSize} key={month.x} style={style}>\n        {month.label}\n      </text>\n    ));\n  }\n\n  function renderBlocks(blocks: GraphData['blocks']) {\n    const theme = getTheme();\n    const textHeight = Math.round(fontSize * LINE_HEIGHT);\n\n    return blocks\n      .map(week =>\n        week.map((day, y) => (\n          <rect\n            x=\"0\"\n            y={textHeight + (blockSize + blockMargin) * y}\n            width={blockSize}\n            height={blockSize}\n            fill={theme[`grade${day.info ? day.info.intensity : 0}`]}\n            data-tip={day.info ? getTooltipMessage(day as Required<Block>) : null}\n            key={day.date}\n          />\n        )),\n      )\n      .map((week, x) => (\n        <g key={x} transform={`translate(${(blockSize + blockMargin) * x}, 0)`}>\n          {week}\n        </g>\n      ));\n  }\n\n  function renderMeta(year: number, totalCount: number) {\n    const isCurrentYear = getYear(new Date()) === year;\n\n    return (\n      <div className={getClassName('meta')} style={{ fontSize }}>\n        {isCurrentYear && fullYear ? 'Last year' : year}\n        {' – '}\n        {isCurrentYear && !fullYear ? 'So far ' : null}\n        {totalCount} contributions\n      </div>\n    );\n  }\n\n  const { width, height } = getDimensions();\n\n  if (error) {\n    console.error(error);\n    return <p>Error :(</p>;\n  }\n\n  if (!graphs) {\n    return <div className={getClassName('loading', styles.loading)}>Loading...</div>;\n  }\n\n  return (\n    <article className={NAMESPACE} style={style}>\n      {graphs.map(graph => {\n        const { year, blocks, monthLabels, totalCount } = graph;\n\n        return (\n          <div key={year} className={getClassName('chart', styles.chart)}>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width={width}\n              height={height}\n              viewBox={`0 0 ${width} ${height}`}\n              className={getClassName('calendar', styles.calendar)}\n              style={{ backgroundColor: theme?.background }}\n            >\n              {renderMonthLabels(monthLabels)}\n              {renderBlocks(blocks)}\n            </svg>\n\n            {renderMeta(year, totalCount)}\n            {children}\n          </div>\n        );\n      })}\n    </article>\n  );\n};\n"],"names":["DEFAULT_THEME","background","text","grade4","grade3","grade2","grade1","grade0","NAMESPACE","LINE_HEIGHT","MIN_DISTANCE_MONTH_LABELS","usePrevious","value","ref","useRef","useEffect","current","DATE_FORMAT","getContributionsForDate","data","date","contributions","find","contrib","getContributionCountForLastYear","now","Date","begin","findIndex","format","end","subYears","length","slice","reduce","acc","count","getContributionCountForYear","year","yearEntry","years","entry","String","total","getBlocksForYear","fullYear","firstDate","parseISO","lastDate","weekStart","getDay","addDays","firstRowDates","push","info","setDay","map","dateObj","dates","i","isAfter","getMonthLabels","blocks","weeks","previousMonth","labels","week","x","firstWeekDay","month","getMonth","monthChanged","firstMonthIsDecember","label","getGraphDataForYear","monthLabels","totalCount","getGitHubGraphData","options","Error","isCurrentYear","isSameYear","createCalendarTheme","baseColor","textColor","emptyCellColor","color","darken","toHslString","base","isValid","setAlpha","getClassName","name","extra","Heatmap","blockSize","blockMargin","children","undefined","dateFormat","fontSize","theme","style","Number","graphs","setGraphs","useState","error","setError","prevYears","prevFullYear","fetchData","useCallback","some","y","includes","getTheme","Object","assign","getDimensions","textHeight","Math","round","width","height","getTooltipMessage","day","renderMonthLabels","fill","shift","renderBlocks","intensity","renderMeta","getYear","console","styles","loading","graph","chart","calendar","backgroundColor"],"mappings":"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"}